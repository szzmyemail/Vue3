# report-platform-jssdk

### Introduction
To make report platform easier for other platforms to use, we build report service as a jssdk. If you want to use report service, you can just import the jssdk and code UI logic. Let us begin with this repository.

### How to get started
1. Install the dependencies: npm install
2. Build JSsdk package: npx rollup -c rollup.config.js
3. Put the bundle.js where you need


### How to use
We build control hub sdk and partner hub sdk separately for deffirent business logic. You can select the sdk according to your business.

If you want to use in your platform, just do like thisL:
Firstly, you need import the sdk(eg: import { reportPlatformCHJSsdk } from './bundle.js') and initialize the basic info.
```
reportPlatformCHJSsdk.initialize({
      Authorization: string,
      Env: string,
      Version: string, //'v1'
      orgId: string,
    });
```

Then when use the jssdk, can call the related function, these functions always return a Promise, that means you can use .then or .catch to get the response.
- Create report, call createReport like this:
```
reportPlatformCHJSsdk
      .createReport(
          region: string, //'AMER' or 'EMEA'
          templateId: string, 
          startDate: string, //'YYYY-MM-DD'
          endDate: string, //'YYYY-MM-DD'
          ifNotification: string, // 'true' or 'false'
          site: string, // if site level report, need site, otherwise ''
          baseTemplateId: string // if generate custom template report, need baseTemplateId, otherwise ''
      )
```

- Schedule report, call scheduleReport like this:
```
reportPlatformCHJSsdk
      .scheduleReport(
          region: string, //'AMER' or 'EMEA'
          templateId: string, 
          baseTemplateId: string // if generate custom template report, need baseTemplateId, otherwise ''
          dateRange: number, 
          cronJobExpression: string,
          expiredTime: string,
          maxOccurTimes: number, 
          cronItems: string,
          site: string, // if site level report, need site, otherwise ''
          ifNotification: string, // 'true' or 'false'
      )
```

- List templates, call listTemplates like this:
```
reportPlatformCHJSsdk.listCustomTemplate(region: string)
```

- List reports created, call listReports like this:
```
reportPlatformCHJSsdk.getReportList(region: string)
```

- List jobs scheduled, call getScheduledJobs like this:
```
reportPlatformCHJSsdk.getScheduledJobs(region: string)
```

- Delete created reports, call deleteReport like this:
reportIds are Array of reportIds you want to deleted.
```
reportPlatformCHJSsdk.deleteReport(region, reportIds)
```

- Download created reports, just get the downloadDomain from getReportList api and then you can download from the link.

- Pause or reboot jobs scheduled, call rebootOrPauseScheduledJob like this:
job is the detail object get from getScheduledJobs function.
```
reportPlatformCHJSsdk.rebootOrPauseScheduledJob(region, job)
```

- Delete jobs scheduled, call deleteScheduledJob like this:
jobId is job id get from getScheduledJobs function.
```
reportPlatformCHJSsdk.deleteScheduledJob(region, jobId)
```

- Set notify status of jobs scheduled, call notifySettingScheduledJob like this:
job is the detail object get from getScheduledJobs function.
```
reportPlatformCHJSsdk.notifySettingScheduledJob(region, job)
```
